<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  <title>newlove / questionnaire</title>

  <!-- 간단 웹폰트 (한글은 Noto Sans KR, 상단 영어는 Orbitron 느낌) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Orbitron:wght@600&display=swap" rel="stylesheet">

  <style>
    :root{
      --blue:#3654ff;
      --fg:#f5f5ff;
      --soft:#7e82b8;
    }

    * { box-sizing:border-box; }

    html, body {
      height:100%;
      margin:0;
    }

    body{
      background:#000;                 /* 완전 검정 */
      color:var(--fg);
      font-family: "Noto Sans KR", system-ui, -apple-system, sans-serif;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      overflow:hidden;
    }

    /* 화면 전체에 살짝 푸른빛 */
    .overlay{
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(circle at 50% -10%, rgba(54,84,255,.45), transparent 55%);
      opacity:.9;
      z-index:-1;
    }

    .frame{
      width:min(92vw, 720px);
      max-height:92vh;
      background:rgba(0,0,0,.96);
      border-radius:18px;
      border:1px solid rgba(54,84,255,.55);
      box-shadow:
        0 0 40px rgba(54,84,255,.45),
        0 26px 80px rgba(0,0,0,1);
      padding:22px 22px 18px;
      display:flex;
      flex-direction:column;
      gap:18px;
      position:relative;
      overflow:hidden;
    }

    /* 상단 HUD 장식 느낌 */
    .frame::before{
      content:"";
      position:absolute;
      left:-40px;
      right:-40px;
      top:0;
      height:26px;
      background:
        linear-gradient(90deg,
          var(--blue) 0 24%,
          transparent 24% 28%,
          var(--blue) 28% 40%,
          transparent 40% 44%,
          var(--blue) 44% 56%,
          transparent 56% 60%,
          var(--blue) 60% 100%);
      opacity:.9;
      clip-path:polygon(0 0,100% 0,100% 70%,0 35%);
    }

    .header{
      margin-top:10px;
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      font-size:12px;
      color:var(--soft);
      letter-spacing:.05em;
      z-index:1;
    }

    .header-title{
      font-family:"Orbitron","Noto Sans KR",system-ui;
      font-weight:600;
      font-size:13px;
      color:var(--blue);
    }

    .header-sub{
      color:#4f5275;
      font-size:11px;
    }

    .question-no{
      margin-top:10px;
      font-size:13px;
      color:var(--blue);
      letter-spacing:.16em;
      text-transform:uppercase;
      text-align:center;
    }

    .question-text{
      margin-top:12px;
      font-size:22px;
      line-height:1.5;
      text-align:center;
      white-space:pre-wrap;
      color:#ffffff;
      text-shadow:
        0 0 8px rgba(255,255,255,.9),
        0 0 20px rgba(54,84,255,.7);
    }

    .choices{
      margin-top:40px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .choice-btn{
      position:relative;
      width:100%;
      border:none;
      background:transparent;
      color:#ffffff;
      padding:14px 22px;
      text-align:left;
      font-size:15px;
      cursor:pointer;
      overflow:hidden;
      font-family:"Noto Sans KR",system-ui;
      letter-spacing:.01em;
      transition:transform .06s ease;
    }

    /* 파란 각진 테두리 (간단 버전) */
    .choice-btn::before{
      content:"";
      position:absolute;
      inset:0;
      border:2px solid var(--blue);
      border-radius:10px;
      box-shadow:0 0 18px rgba(54,84,255,.6);
      opacity:.9;
      pointer-events:none;
    }

    .choice-btn span{
      position:relative;
      z-index:1;
    }

    .choice-btn:hover{
      transform:translateY(-1px);
    }

    .choice-btn:hover::before{
      box-shadow:0 0 26px rgba(54,84,255,1);
    }

    .choice-btn:active{
      transform:translateY(1px);
    }

    .system-text{
      margin-top:18px;
      font-size:11px;
      color:#5f648e;
      line-height:1.6;
    }
    .system-text b{
      color:#c3c5ff;
    }

    .footer{
      margin-top:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:11px;
      color:#45496e;
    }

    .glitch{
      color:#ff4b7a;
      text-shadow:
        0 0 3px rgba(255,75,122,.8),
        -2px 0 3px rgba(0,255,255,.35),
        2px 0 3px rgba(0,0,0,.9);
    }

    .screen-dark{
      animation: fadeToBlack 3s forwards;
    }
    @keyframes fadeToBlack{
      to{
        background:#000;
        color:#b6b6ff;
      }
    }
  </style>
</head>

<body>
  <div class="overlay"></div>

  <div class="frame" id="frame">
    <div class="header">
      <div>
        <div class="header-title">NEWLOVE / INPUT TEST</div>
        <div class="header-sub" id="subtitle">응답을 선택해 진행하세요.</div>
      </div>
      <div><span id="stepLabel">STEP 1</span></div>
    </div>

    <div>
      <div class="question-no" id="qNo">Q1</div>
      <div class="question-text" id="qText">...</div>
    </div>

    <div class="choices" id="choiceBox"></div>

    <div class="system-text" id="systemHint">
      일부 인앱 브라우저에서는 미니 화면·소리가 제대로 동작하지 않을 수 있어요.<br>
      문제가 생기면 <b>우측 상단 ⋮ → “다른 브라우저로 열기”</b>로 다시 시도해 주세요.
    </div>

    <div class="footer">
      <span>NODE: <span id="nodeIdView">q1</span></span>
      <span>world: newlove-questionnaire</span>
    </div>
  </div>

  <!-- 배경음: 같은 폴더에 bgm.mp3 올려놓기 -->
  <audio id="bgm" src="bgm.mp3" loop preload="auto"></audio>

  <!-- 엔딩 때 재생되는 보이스 (있으면 사용, 아니면 지워도 됨) -->
  <audio id="voice" src="voice.mp3" preload="auto"></audio>

  <script>
    // ===== 스토리 노드 정의 =====
    const NODES = {
      q1: {
        id: "q1",
        label: "Q1",
        text: `...들리십니까?`,
        options: [
          { label: "네", next: "q2" },
          { label: "아니오", next: "q2" }
        ]
      },
      q2: {
        id: "q2",
        label: "Q2",
        text: `“당신은 누구십니까?”`,
        options: [
          { label: "...", next: "q3" }
        ]
      },
      q3: {
        id: "q3",
        label: "Q3",
        text: `“당신은 제가 누구인지 알고있습니까?”`,
        options: [
          { label: "알고있어요.", next: "q3_1" },
          { label: "잘 모르겠어요.", next: "q4" }
        ]
      },
      q3_1: {
        id: "q3_1",
        label: "Q3-1",
        text: `“....확실합니까?"`,
        options: [
          { label: "네, 저는 당신이 누군지 알아요.", next: "q4" },
          { label: "사실 잘 모르겠습니다.", next: "q4" },
          { label: "글쎄요...", next: "q4" }
        ]
      },
      q4: {
        id: "q4",
        label: "Q4",
        text: `“만약 당신의 소중한 사람이 눈앞에서 죽어간다면,
하지만 다시 되살릴 수 있다면 살리겠습니까, 방관하시겠습니까?”`,
        options: [
          {
            label: "어떻게든 살려낸다.",
            next: "q5",
            reaction: "그렇군요. 당신은 그렇군요."
          },
          {
            label: "살리지 않는다.",
            next: "q5",
            reaction: "그렇군요. 당신은 그렇군요."
          },
          {
            label: "서서히 죽어가도록 내버려둔다.",
            next: "q5",
            reaction: `Error Error Error Error Error Error
Error Error Error
Error Error Error
Error Error Error Error Error Error`,
            glitch: true
          }
        ]
      },
      q5: {
        id: "q5",
        label: "Q5",
        text: `“당신은 소중한 사람이 죽을 때마다 살려낼 것 입니까?
아니면, 또다시 서서히 죽어가게 내버려두겠습니까?”`,
        options: [
          {
            label: "소중한 사람을 잃고 싶지 않아요. 어떻게든 끝까지 노력해서 살려낼 겁니다.",
            next: "q6"
          },
          {
            label: "이젠 포기하고, 죽어가게 내버려둘 겁니다.",
            next: "q6"
          },
          {
            label: "딱히 관심 없어요. 아무렇지도 않을 것 같아요.",
            next: "q6"
          }
        ]
      },
      q6: {
        id: "q6",
        label: "Q6",
        text: `“어떤 방식이든 가능하기만 하다면,
계속해서 삶을 이어갈 수 있다고 생각하십니까?”`,
        options: [
          { label: "...그럴 수는 없죠.", next: "q7" },
          { label: "네, 분명히요. 언젠가는 그런 경험을 하게 될 날이 올 거라고 믿어요.", next: "q7" },
          { label: "그런 거엔 관심이 없어요.", next: "q7" }
        ]
      },
      q7: {
        id: "q7",
        label: "Q7",
        text: `“마지막으로.... 당신은 자신이 어떤 존재인지 알고 있습니까?”`,
        options: [
          { label: "저는 제가 어떤 존재인지 완벽히 이해하고 있습니다.", next: "END" },
          { label: "...저는 단 하나로는 정의하기 어렵습니다.", next: "END" },
          { label: "......잘 모르겠습니다.", next: "END" }
        ]
      }
    };

    // ===== 상태 =====
    let currentId = "q1";
    let bgmStarted = false;

    const qNoEl = document.getElementById("qNo");
    const qTextEl = document.getElementById("qText");
    const choiceBox = document.getElementById("choiceBox");
    const stepLabel = document.getElementById("stepLabel");
    const nodeIdView = document.getElementById("nodeIdView");
    const frameEl = document.getElementById("frame");
    const voiceEl = document.getElementById("voice");
    const bgmEl = document.getElementById("bgm");

    // 첫 번째 아무 클릭에서 BGM 재생 시도 (모바일 자동재생 우회)
    document.addEventListener("click", () => {
      if (!bgmStarted && bgmEl) {
        bgmEl.play().catch(() => {});
        bgmStarted = true;
      }
    }, { once:true });

    function renderNode(id){
      const node = NODES[id];
      if(!node){ return; }
      currentId = id;

      qNoEl.textContent = node.label;
      qTextEl.classList.remove("glitch");
      qTextEl.textContent = node.text;
      stepLabel.textContent = "STEP " + node.label.replace("Q","");
      nodeIdView.textContent = node.id;

      choiceBox.innerHTML = "";
      node.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.className = "choice-btn";

        const span = document.createElement("span");
        span.textContent = opt.label;
        btn.appendChild(span);

        btn.addEventListener("click", () => handleChoice(node, opt));
        choiceBox.appendChild(btn);
      });
    }

    function handleChoice(node, opt){
      // Q4에서만 반응 문장 출력
      if (opt.reaction){
        qTextEl.textContent = opt.reaction;
        choiceBox.innerHTML = "";
        if (opt.glitch){
          qTextEl.classList.add("glitch");
        }
        setTimeout(() => {
          renderNode(opt.next);
        }, 1700);
        return;
      }

      if (opt.next === "END"){
        showEnding();
        return;
      }

      renderNode(opt.next);
    }

    function showEnding(){
      qNoEl.textContent = "END";
      qTextEl.classList.add("glitch");
      qTextEl.innerHTML =
        `“협조에 감사를 드립니다.<br>` +
        `당신의 데이터 키트 제작이 완료되었습니다.”<br><br>` +
        `<span class="glitch">당신의ㅣㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇ<br>Error.</span>`;

      choiceBox.innerHTML = "";
      stepLabel.textContent = "COMPLETE";
      nodeIdView.textContent = "end";

      document.body.classList.add("screen-dark");

      if (voiceEl){
        voiceEl.play().catch(() => {});
      }
    }

    // 시작
    renderNode(currentId);
  </script>
</body>
</html>
